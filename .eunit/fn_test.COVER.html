<html>
<head><title>.eunit/fn_test.COVER.html</title></head><body bgcolor=white text=black>
<pre>
File generated from /Users/reid/Documents/repos/masters/fn/.eunit/fn_test.erl by COVER 2013-06-19 at 14:44:56

****************************************************************************

        |  %% -------------------------------------------------------------------
        |  %% Copyright (c) 2012 Reid Draper. All Rights Reserved.
        |  %%
        |  %% This file is provided to you under the Apache License,
        |  %% Version 2.0 (the "License"); you may not use this file
        |  %% except in compliance with the License.  You may obtain
        |  %% a copy of the License at
        |  %%
        |  %%   http://www.apache.org/licenses/LICENSE-2.0
        |  %%
        |  %% Unless required by applicable law or agreed to in writing,
        |  %% software distributed under the License is distributed on an
        |  %% "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        |  %% KIND, either express or implied.  See the License for the
        |  %% specific language governing permissions and limitations
        |  %% under the License.
        |  %%
        |  %% -------------------------------------------------------------------
        |  
        |  -module(fn_test).
        |  
        |  -compile(export_all).
        |  
        |  -ifdef(TEST).
        |  
        |  -include_lib("eunit/include/eunit.hrl").
        |  
        |  list_of_terms() -&gt;
     5..|      [1,
        |       2,
        |       "",
        |       "a",
        |       "b",
        |       &lt;&lt;"abc"&gt;&gt;,
        |       &lt;&lt;""&gt;&gt;,
        |       self(),
        |       node()].
        |  
        |  %% Arity
        |  
        |  arity1_test() -&gt;
     1..|      F1 = fun (_A) -&gt; ok end,
     1..|      ?assertEqual(fn:arity(F1), 1).
        |  
        |  arity2_test() -&gt;
     1..|      F2 = fun (_A, _B) -&gt; ok end,
     1..|      ?assertEqual(fn:arity(F2), 2).
        |  
        |  arity3_test() -&gt;
     1..|      F3 = fun (_A, _B, _C) -&gt; ok end,
     1..|      ?assertEqual(fn:arity(F3), 3).
        |  
        |  arity4_test() -&gt;
     1..|      F4 = fun (_A, _B, _C, _D) -&gt; ok end,
     1..|      ?assertEqual(fn:arity(F4), 4).
        |  
        |  %% Identity
        |  
        |  identity_suite_test_() -&gt;
     1..|      {setup,
     1..|       fun () -&gt; ok end,
     9..|       [identity_builder(V) || V &lt;- list_of_terms()]
        |      }.
        |  
        |  identity_builder(Value) -&gt;
     9..|      fun () -&gt;
     9..|              ?assertEqual(Value, fn:identity(Value))
        |      end.
        |  
        |  %% Constantly
        |  
        |  constantly_suite_test_() -&gt;
     1..|      {setup,
     1..|       fun () -&gt; ok end,
    36..|       [constantly_builder(Arity, Val) || Arity &lt;- lists:seq(0, 3),
     4..|                                          Val &lt;- list_of_terms()]
        |      }.
        |  
        |  constantly_builder(Arity, Val) -&gt;
    36..|      Constantly = fn:constantly(Arity, Val),
    36..|      fun () -&gt;
    36..|              Result = eval_arity(Arity, Constantly),
    36..|              ?assertEqual(Result, Val)
        |      end.
        |  
        |  eval_arity(0, Fun) -&gt;
     9..|      Fun();
        |  eval_arity(1, Fun) -&gt;
     9..|      Fun(foo);
        |  eval_arity(2, Fun) -&gt;
     9..|      Fun(foo, bar);
        |  eval_arity(3, Fun) -&gt;
     9..|      Fun(foo, bar, baz).
        |  
        |  
        |  %% Complement
        |  
        |  truthy() -&gt;
     4..|      true.
        |  
        |  falsy() -&gt;
<font color=red>     0..|      false.</font>
        |  
        |  truthy_test() -&gt;
     1..|      ?assertEqual(truthy(),
     1..|                   not (fn:complement(fun truthy/0))()).
        |  
        |  falsy_test() -&gt;
     1..|      ?assertEqual(truthy(),
     1..|                   not (fn:complement(fun truthy/0))()).
        |  
        |  %% Comp (compose)
        |  
        |  add_one(Arg) -&gt;
     8..|      Arg + 1.
        |  
        |  add_two(Arg) -&gt;
     2..|      Arg + 2.
        |  
        |  mul_two(Arg) -&gt;
     6..|      Arg * 2.
        |  
        |  mul_three(Arg) -&gt;
     2..|      Arg * 3.
        |  
        |  comp_1_test() -&gt;
     1..|      Fun = fn:comp([fun mul_two/1,
        |                     fun add_one/1,
        |                     fun add_one/1]),
     1..|      ?assertEqual(Fun(10), 24).
        |  
        |  comp_2_test() -&gt;
     1..|      Fun = fn:comp([fun add_one/1,
        |                     fun add_one/1,
        |                     fun mul_two/1]),
     1..|      ?assertEqual(Fun(10), 22).
        |  
        |  comp_3_test() -&gt;
     1..|      Fun = fn:comp(fun add_one/1, fun mul_two/1),
     1..|      ?assertEqual(Fun(55), 111).
        |  
        |  comp_4_test() -&gt;
     1..|      Fun = fn:comp(fun mul_two/1, fun add_one/1),
     1..|      ?assertEqual(Fun(55), 112).
        |  
        |  comp_5_test() -&gt;
        |      %% these functions commute
     1..|      F1 = fn:comp(fun add_one/1, fun add_two/1),
     1..|      F2 = fn:comp(fun add_two/1, fun add_one/1),
     1..|      ?assertEqual(F1(47), F2(47)).
        |  
        |  comp_6_test() -&gt;
        |      %% these functions commute
     1..|      F1 = fn:comp(fun mul_two/1, fun mul_three/1),
     1..|      F2 = fn:comp(fun mul_three/1, fun mul_two/1),
     1..|      ?assertEqual(F1(47), F2(47)).
        |  
        |  %% Partial
        |  
        |  partial_1_test() -&gt;
     1..|      Fun = fun erlang:'+'/2,
     1..|      ?assertEqual((fn:partial(Fun, 5))(7), 12).
        |  
        |  partial_2_test() -&gt;
     1..|      Fun = fun erlang:'+'/2,
     1..|      ?assertEqual((fn:partial(Fun, 1))(1), 2).
        |  
        |  partial_3_test() -&gt;
     1..|      Fun = fun (A, B, C) -&gt; lists:foldl(fun erlang:'+'/2, 0, [A, B, C]) end,
     1..|      ?assertEqual((fn:partial(Fun, 3))(5, 7), 15).
        |  
        |  partial_4_test() -&gt;
     1..|      Fun = fun (A, B, C) -&gt; lists:foldl(fun erlang:'+'/2, 0, [A, B, C]) end,
     1..|      PartialOne = fn:partial(Fun, 3),
     1..|      ?assertEqual((fn:partial(PartialOne, 5))(7), 15).
        |  
        |  %% Flip
        |  
        |  integer_pairs() -&gt;
     1..|      [{1, 2},
        |       {5, 99},
        |       {10, 5},
        |       {10, 4},
        |       {77, 77},
        |       {90, 1001}].
        |  
        |  flip_builder(A, B) -&gt;
        |      %% `Fun' must not be commutative
     6..|      Fun = fun erlang:'/'/2,
     6..|      fun () -&gt;
     6..|              ?assertEqual(erlang:apply(Fun, [A, B]),
     6..|                           erlang:apply(fn:flip(Fun), [B, A]))
        |      end.
        |  
        |  flip_suite_test_() -&gt;
     1..|      {setup,
     1..|       fun () -&gt; ok end,
     6..|       [flip_builder(A, B) || {A, B} &lt;- integer_pairs()]
        |      }.
        |  
        |  -endif.
</pre>
</body>
</html>
